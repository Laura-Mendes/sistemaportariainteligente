{% extends "base.html" %}

{% block content %}

<nav class="navbar" style="padding: 10px 24px;">
  <a class="navbar-brand">
    <div class="navbar-brand fw-bold mt-2" style="font-size: 35px; color: rgb(27, 27, 27);">Histórico</div>
  </a>
</nav>

<main class="container-fluid px-4 fade-in">

<br>

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, message in messages %}
      <div class="alert alert-{{ category }} text-center w-50 mx-auto mt-3" style="background-color: #DBEAFF; color: #2f60e6; border: 1px solid #2f60e6;">
        <p style="margin: 0;">{{ message }}</p>
        <button type="button" class="btn-close position-absolute end-0 top-50 translate-middle-y me-2" data-bs-dismiss="alert" aria-label="Fechar"></button>
      </div>
    {% endfor %}
  {% endif %}
{% endwith %}

<div class="info d-flex mt-2" 
     style="background-color: #fff; padding: 13px; border-radius: 12px;
            box-shadow: 2px 5px 8px rgba(0, 0, 0, 0.1);">

  <div class="navbar-container" style="flex: 1; width: 100%;"> 
    <form method="GET" action="{{ url_for('historico_bp.listar_historico') }}" style="width: 100%;">
      <div class="search-container" 
           style="display: flex; align-items: center; border: 1px solid #c3c3c3;
                  border-radius: 4px; padding: 5px; margin-right: 10px; width: 100%;">
        <i class="bi bi-search ms-2 me-2 fs-6" style="color: #838282e8;"></i>
        <input type="text" name="q"
               style="padding: 5px; font-size: 16px; border: none; border-radius: 4px; width: 100%;" 
               placeholder="Pesquisar por ação..."
               value="{{ request.args.get('q', '') }}">
      </div>
    </form>
  </div>
</div>

<br>

<div class="ag-courses-item_bg"></div>

  <div class="table-responsive" 
     style="max-height: 450px; overflow-y: auto; border-radius: 8px;"> <!-- SCROLL - Barra de rolagem -->
    <table class="table table-striped table-bordered align-middle">
      <thead class="table" style="font-size: 14px; border: 1px rgba(134, 134, 134, 0.473);">
        <tr>
          <th class="py-3 text-center">USUÁRIO</th>
          <th class="py-3 text-center">AÇÃO</th>
          <th class="py-3 text-center">ENTIDADE</th>   
          <th class="py-3 text-center">DATA</th>
          <th class="py-3 text-center">HORA</th>
        </tr>
      </thead>

      <tbody>
            {% for item in historico %}
            <tr>
                <td class="py-3">{{ item.usuario }}</td>
                <td class="py-3">{{ item.acao }}</td>
                <td class="py-3">{{ item.entidade }}</td>
                <td class="py-3">{{ item.data_registro.strftime('%d/%m/%Y') }}</td>
                <td class="py-3">{{ item.hora_registro.strftime('%H:%M:%S') }}</td>
            </tr>
            {% else %}
        <tr>
          <td colspan="5" class="text-center">Nenhum registro encontrado.</td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
  </div>

</main>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

{% endblock %}
